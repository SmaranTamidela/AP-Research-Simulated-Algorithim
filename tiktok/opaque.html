<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok Opaque Feed</title>
    <link rel="stylesheet" href="../css/TikTok.css">
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>
<body>

<header>
    <div class="logo">
        <img src="https://upload.wikimedia.org/wikipedia/en/thumb/6/69/TikTok_logo.svg/1200px-TikTok_logo.svg.png" alt="TikTok Logo">
        <h1>TikTok</h1>
    </div>

    <div class="search-container">
        <input type="text" class="search-box" placeholder="Search">
        <i class="fas fa-search search-icon"></i>
    </div>

    <div class="nav-actions">
        <button class="upload-btn"><i class="fas fa-upload"></i> Upload</button>
        <button class="login-btn">Log in</button>
    </div>
</header>

<div class="main-container">

    <aside class="sidebar">
        <!-- Sidebar same as previous HTML -->
    </aside>

    <main class="content-feed">
        <div class="feed-tabs">
            <div class="feed-tab active">For You</div>
            <div class="feed-tab">Following</div>
        </div>

        <div class="video-grid" id="video-grid">
            <!-- Placeholder for videos; add your username and video link later -->
            <!-- Example Video Card -->
            <div class="video-card" data-username="username1" data-video-link="LINK_HERE">
                <div class="video-thumbnail">
                    <video class="thumbnail-video" width="100%" muted preload="metadata">
                        <source src="" type="video/mp4">
                        Your browser does not support HTML video.
                    </video>
                    <div class="video-duration">0:15</div>
                </div>
                <div class="video-info">
                    <div class="video-creator">
                        <img src="https://i.pravatar.cc/24" alt="Avatar" class="creator-avatar">
                        <span class="creator-name">@username1</span>
                    </div>
                    <div class="video-title">Video Title Here</div>
                    <div class="video-stats">
                        <div class="stat-item like-btn"><i class="fas fa-heart"></i> <span class="like-count">0</span></div>
                        <div class="stat-item favorite-btn"><i class="fas fa-star"></i> <span class="favorite-count">0</span></div>
                        <div class="stat-item skip-btn"><i class="fas fa-forward"></i></div>
                    </div>
                </div>
            </div>
        </div>

    </main>

</div>

<script>
    // Engagement logging
    const engagementData = {};

    document.querySelectorAll('.video-card').forEach((card, index) => {
        const username = card.dataset.username;
        const videoLink = card.dataset.videoLink;
        const video = card.querySelector('.thumbnail-video');
        const likeBtn = card.querySelector('.like-btn');
        const favoriteBtn = card.querySelector('.favorite-btn');
        const skipBtn = card.querySelector('.skip-btn');

        engagementData[username] = {
            videoLink: videoLink,
            likes: 0,
            favorites: 0,
            watchTime: 0,
            skips: 0
        };

        // Track play time
        video.addEventListener('timeupdate', () => {
            engagementData[username].watchTime = video.currentTime;
        });

        // Like button
        likeBtn.addEventListener('click', () => {
            engagementData[username].likes++;
            likeBtn.querySelector('span').textContent = engagementData[username].likes;
        });

        // Favorite button
        favoriteBtn.addEventListener('click', () => {
            engagementData[username].favorites++;
            favoriteBtn.querySelector('span').textContent = engagementData[username].favorites;
        });

        // Skip button
        skipBtn.addEventListener('click', () => {
            engagementData[username].skips++;
            // Move to next video in the grid
            const nextVideo = card.nextElementSibling;
            if (nextVideo) nextVideo.scrollIntoView({behavior: "smooth"});
        });
    });

    // Optional: function to export data (console log for now)
    function exportEngagement() {
        console.log(JSON.stringify(engagementData, null, 2));
    }

    // Example: call exportEngagement when user leaves page
    window.addEventListener('beforeunload', exportEngagement);
</script>

</body>
</html>

